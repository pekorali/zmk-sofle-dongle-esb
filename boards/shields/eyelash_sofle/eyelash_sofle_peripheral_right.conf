#
# Copyright (c) 2026 The ZMK Contributors
# SPDX-License-Identifier: MIT
#

# Disable unused SPI
CONFIG_SPI=n
CONFIG_PWM=n
CONFIG_I2C=n
CONFIG_PWM_NRFX=n
#EXT POWER
CONFIG_ZMK_EXT_POWER=y

# Disable unused display on right hand
CONFIG_ZMK_DISPLAY=n

# Disable unused battery reporting to dongle for simple dongle variant witout screen(just N!N with soldered Reset button)
#   CONFIG_ZMK_BATTERY=y
#   CONFIG_ZMK_BATTERY_REPORTING=n
#   CONFIG_ZMK_BATTERY_REPORT_INTERVAL=600000

# Disable Deep Sleep MCU mode because currently it's dont work with PS/2(trackpoint stops working after wake up by pressing any key)
CONFIG_ZMK_SLEEP=n
# Go to sleep after 20 mins (20*60*1000ms)
# CONFIG_ZMK_IDLE_SLEEP_TIMEOUT=1200000
# Go to idle state after 2 min (2*60*1000ms)
# Keep IDLE mode ON
CONFIG_ZMK_IDLE_TIMEOUT=12000
CONFIG_ZMK_PM_SOFT_OFF=y


#EC11 encoders enable
CONFIG_EC11=y
CONFIG_EC11_TRIGGER_GLOBAL_THREAD=y

# Force right side to be peripheral (not central)
CONFIG_ZMK_SPLIT_ROLE_CENTRAL=n

# Type-C USB on right hand MCU used only for charging and firmware update
CONFIG_ZMK_USB=n

# Disable BLE entirely
CONFIG_ZMK_BLE=n

# Disable BLE split, enable ESB
CONFIG_ZMK_SPLIT_BLE=n
CONFIG_ZMK_SPLIT_WIRED=n
CONFIG_ZMK_SPLIT_ESB=y
# assige a source id on peripheral. (no need for central)
# default zero. give an integer (<256) on all peripheral(s)
CONFIG_ZMK_SPLIT_ESB_PERIPHERAL_ID=2

# ESB settings
CONFIG_MPSL_TIMESLOT_SESSION_COUNT=1
CONFIG_SYSTEM_WORKQUEUE_STACK_SIZE=2048
CONFIG_ESB_MAX_PAYLOAD_LENGTH=48
CONFIG_ZMK_SPLIT_ESB_PROTO_TX_ACK=y
CONFIG_MPSL_TIMESLOT_SESSION_COUNT=1

# Enable pointing/mouse support for PS/2 trackpoint
CONFIG_ZMK_POINTING=y
#CONFIG_ZMK_POINTING_SMOOTH_SCROLLING=y
CONFIG_INPUT=y
CONFIG_GPIO=y

# UART-based PS/2 driver config
CONFIG_UART_INTERRUPT_DRIVEN=y
CONFIG_PS2_UART_WRITE_MODE_BLOCKING=y
CONFIG_ZMK_INPUT_MOUSE_PS2_POWER_ON_RESET_TIME=1900

# Enable automatic crash recovery using the reset pin
# Triggers after 15 consecutive errors, 30s cooldown between attempts
CONFIG_ZMK_INPUT_MOUSE_PS2_ENABLE_CRASH_RECOVERY=y

# USB Logging (re-enabled for crash debugging)
#CONFIG_ZMK_USB_LOGGING=y
#   CONFIG_LOG=y
#CONFIG_USB_CDC_ACM=y
#CONFIG_SERIAL=y
#CONFIG_CONSOLE=y
#CONFIG_UART_CONSOLE=y
#CONFIG_UART_LINE_CTRL=y

# PS2/Trackpoint logging - WRN level for crash debugging
# CONFIG_PS2_LOG_LEVEL_WRN=y
# CONFIG_INPUT_LOG_LEVEL_WRN=y
# CONFIG_UART_LOG_LEVEL_WRN=y
# CONFIG_ZMK_LOG_LEVEL_INF=y

# Enable writing to flash
CONFIG_USE_DT_CODE_PARTITION=y
CONFIG_BUILD_OUTPUT_UF2=y
CONFIG_MPU_ALLOW_FLASH_WRITE=y
CONFIG_NVS=y
CONFIG_SETTINGS_NVS=y
CONFIG_FLASH=y
CONFIG_FLASH_PAGE_LAYOUT=y
CONFIG_FLASH_MAP=y















